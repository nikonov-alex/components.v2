var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.d(t,{uA:()=>_,s2:()=>E,Aq:()=>r});var i={};e.r(i),e.d(i,{boolean:()=>y,number:()=>N});var n={};e.r(n),e.d(n,{optional:()=>S,required:()=>w,update:()=>A});var a,r={};e.r(r),e.d(r,{ObjectBuilder:()=>n,Parse:()=>i});var o="undefined"==typeof document?void 0:document,s=!!o&&"content"in o.createElement("template"),d=!!o&&o.createRange&&"createContextualFragment"in o.createRange();function l(e,t){var i,n,a=e.nodeName,r=t.nodeName;return a===r||(i=a.charCodeAt(0),n=r.charCodeAt(0),i<=90&&n>=97?a===r.toUpperCase():n<=90&&i>=97&&r===a.toUpperCase())}function u(e,t,i){e[i]!==t[i]&&(e[i]=t[i],e[i]?e.setAttribute(i,""):e.removeAttribute(i))}var c={OPTION:function(e,t){var i=e.parentNode;if(i){var n=i.nodeName.toUpperCase();"OPTGROUP"===n&&(n=(i=i.parentNode)&&i.nodeName.toUpperCase()),"SELECT"!==n||i.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),i.selectedIndex=-1)}u(e,t,"selected")},INPUT:function(e,t){u(e,t,"checked"),u(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var i=t.value;e.value!==i&&(e.value=i);var n=e.firstChild;if(n){var a=n.nodeValue;if(a==i||!i&&a==e.placeholder)return;n.nodeValue=i}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var i,n,a=-1,r=0,o=e.firstChild;o;)if("OPTGROUP"===(n=o.nodeName&&o.nodeName.toUpperCase()))o=(i=o).firstChild;else{if("OPTION"===n){if(o.hasAttribute("selected")){a=r;break}r++}!(o=o.nextSibling)&&i&&(o=i.nextSibling,i=null)}e.selectedIndex=a}}};function h(){}function f(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const v=function(e,t,i){if(i||(i={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var n=t;(t=o.createElement("html")).innerHTML=n}else r=(r=t).trim(),t=s?function(e){var t=o.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(r):d?function(e){return a||(a=o.createRange()).selectNode(o.body),a.createContextualFragment(e).childNodes[0]}(r):function(e){var t=o.createElement("body");return t.innerHTML=e,t.childNodes[0]}(r);else 11===t.nodeType&&(t=t.firstElementChild);var r,u=i.getNodeKey||f,v=i.onBeforeNodeAdded||h,m=i.onNodeAdded||h,p=i.onBeforeElUpdated||h,b=i.onElUpdated||h,_=i.onBeforeNodeDiscarded||h,g=i.onNodeDiscarded||h,E=i.onBeforeElChildrenUpdated||h,y=i.skipFromChildren||h,N=i.addChild||function(e,t){return e.appendChild(t)},A=!0===i.childrenOnly,S=Object.create(null),w=[];function C(e){w.push(e)}function O(e,t){if(1===e.nodeType)for(var i=e.firstChild;i;){var n=void 0;t&&(n=u(i))?C(n):(g(i),i.firstChild&&O(i,t)),i=i.nextSibling}}function T(e,t,i){!1!==_(e)&&(t&&t.removeChild(e),g(e),O(e,i))}function j(e){m(e);for(var t=e.firstChild;t;){var i=t.nextSibling,n=u(t);if(n){var a=S[n];a&&l(t,a)?(t.parentNode.replaceChild(a,t),x(a,t)):j(t)}else j(t);t=i}}function x(e,t,i){var n=u(t);if(n&&delete S[n],!i){if(!1===p(e,t))return;if(function(e,t){var i,n,a,r,o=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var s=o.length-1;s>=0;s--)n=(i=o[s]).name,a=i.namespaceURI,r=i.value,a?(n=i.localName||n,e.getAttributeNS(a,n)!==r&&("xmlns"===i.prefix&&(n=i.name),e.setAttributeNS(a,n,r))):e.getAttribute(n)!==r&&e.setAttribute(n,r);for(var d=e.attributes,l=d.length-1;l>=0;l--)n=(i=d[l]).name,(a=i.namespaceURI)?(n=i.localName||n,t.hasAttributeNS(a,n)||e.removeAttributeNS(a,n)):t.hasAttribute(n)||e.removeAttribute(n)}}(e,t),b(e),!1===E(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var i,n,a,r,s,d=y(e,t),h=t.firstChild,f=e.firstChild;e:for(;h;){for(r=h.nextSibling,i=u(h);!d&&f;){if(a=f.nextSibling,h.isSameNode&&h.isSameNode(f)){h=r,f=a;continue e}n=u(f);var m=f.nodeType,p=void 0;if(m===h.nodeType&&(1===m?(i?i!==n&&((s=S[i])?a===s?p=!1:(e.insertBefore(s,f),n?C(n):T(f,e,!0),f=s):p=!1):n&&(p=!1),(p=!1!==p&&l(f,h))&&x(f,h)):3!==m&&8!=m||(p=!0,f.nodeValue!==h.nodeValue&&(f.nodeValue=h.nodeValue))),p){h=r,f=a;continue e}n?C(n):T(f,e,!0),f=a}if(i&&(s=S[i])&&l(s,h))d||N(e,s),x(s,h);else{var b=v(h);!1!==b&&(b&&(h=b),h.actualize&&(h=h.actualize(e.ownerDocument||o)),N(e,h),j(h))}h=r,f=a}!function(e,t,i){for(;t;){var n=t.nextSibling;(i=u(t))?C(i):T(t,e,!0),t=n}}(e,f,n);var _=c[e.nodeName];_&&_(e,t)}(e,t):c.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var i=t.firstChild;i;){var n=u(i);n&&(S[n]=i),e(i),i=i.nextSibling}}(e);var V,M,U=e,P=U.nodeType,R=t.nodeType;if(!A)if(1===P)1===R?l(e,t)||(g(e),U=function(e,t){for(var i=e.firstChild;i;){var n=i.nextSibling;t.appendChild(i),i=n}return t}(e,(V=t.nodeName,(M=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==M?o.createElementNS(M,V):o.createElement(V)))):U=t;else if(3===P||8===P){if(R===P)return U.nodeValue!==t.nodeValue&&(U.nodeValue=t.nodeValue),U;U=t}if(U===t)g(e);else{if(t.isSameNode&&t.isSameNode(U))return;if(x(U,t,A),w)for(var L=0,k=w.length;L<k;L++){var I=S[w[L]];I&&T(I,I.parentNode,!1)}}return!A&&U!==e&&e.parentNode&&(U.actualize&&(U=U.actualize(e.ownerDocument||o)),e.parentNode.replaceChild(U,e)),U},m=e=>"get"in e,p=["hashchange","popstate"];class b extends HTMLElement{constructor(e,t){super(),this._globalEvents={},this._deferredRedraw=!1,this._state="function"==typeof e.initialState?e.initialState(window):e.initialState,this._render=e.render,this._viewupdated=e.viewupdated,this._root=this._render(this._state);const i=this.attachShadow({mode:"closed",clonable:!0,delegatesFocus:!0});if(i.appendChild(this._root),t)if("url"in t){const e=document.createElement("link");e.rel="stylesheet",e.href=t.url,i.appendChild(e)}else i.adoptedStyleSheets=[t.stylesheet];var n;e.domchange&&this._connectMutationObserver(e.domchange),e.events&&(this._bindEvents((n=e.events,Object.keys(n).reduce(((e,t)=>p.includes(t)?e:Object.assign(Object.assign({},e),{[t]:n[t]})),{})),i),this._globalEvents=(e=>Object.keys(e).reduce(((t,i)=>p.includes(i)?Object.assign(Object.assign({},t),{[i]:e[i]}):t),{}))(e.events)),e.props&&this._defineProps(e.props),this._emit=e.emit,this._globalEventHandler=this._globalEventHandler.bind(this),this._debug=!!e.debug,this._viewupdated&&this._changeState(this._viewupdated(this._state,this._root))}_defineProps(e){const t=this;for(let[i,n]of Object.entries(e)){const e={};if(m(n)){const i=n.get,a=function(){return i(t._state)};e.get=a,a.bind(e)}Object.defineProperty(this,i,e)}}_bindEvents(e,t){const i=t=>{["submit"].includes(t.type)&&t.preventDefault(),t.stopImmediatePropagation();const i=e[t.type];this._changeState(i(this._state,t,window))};Object.keys(e).forEach((e=>{t.addEventListener(e,i,!0)}))}_globalEventHandler(e){const t=this._globalEvents[e.type];this._changeState(t(this._state,e,window))}connectedCallback(){Object.keys(this._globalEvents).forEach((e=>{window.addEventListener(e,this._globalEventHandler,!0)}))}disconnectedCallback(){Object.keys(this._globalEvents).forEach((e=>{window.removeEventListener(e,this._globalEventHandler,!0)}))}_connectMutationObserver(e){new MutationObserver((t=>{this._changeState(e(this._state,this,window))})).observe(this,{subtree:!0,childList:!0,attributes:!0,characterData:!0})}_redraw(){const e=this._render(this._state);this._root.isEqualNode(e)||(this._root.nodeName!==e.nodeName?(this._root.replaceWith(e),this._root=e):v(this._root,e,{onBeforeElUpdated:(e,t)=>!e.isEqualNode(t)}),this._viewupdated&&this._changeState(this._viewupdated(this._state,this._root)))}_maybeEmitEvents(e){if(this._emit)for(const t of this._emit)t.when(e,this._state)&&(Array.isArray(t.emit)?t.emit.forEach((e=>{this.dispatchEvent(e(this._state))})):this.dispatchEvent(t.emit(this._state)))}_changeState(e){if(this._state===e)return;const t=this._state;this._state=e,this._deferredRedraw||(setTimeout((()=>{this._redraw(),this._deferredRedraw=!1}),0),this._deferredRedraw=!0),this._maybeEmitEvents(t),this._debug&&console.log("nikonov-components: transition from",t,"to",this._state)}}const _=b;class g extends b{constructor(e,t){super(e,t),this._internals=this.attachInternals(),this._formValue=e.formValue,this._validate=e.validate,this._internals.setFormValue(this._formValue(this._state))}_validityDiffers(e){var t,i,n,a,r,o,s,d,l,u;const c=this._internals.validity;return c.valueMissing!==(null!==(t=e.valueMissing)&&void 0!==t&&t)||c.stepMismatch!==(null!==(i=e.stepMismatch)&&void 0!==i&&i)||c.badInput!==(null!==(n=e.badInput)&&void 0!==n&&n)||c.customError!==(null!==(a=e.customError)&&void 0!==a&&a)||c.patternMismatch!==(null!==(r=e.patternMismatch)&&void 0!==r&&r)||c.rangeOverflow!==(null!==(o=e.rangeOverflow)&&void 0!==o&&o)||c.rangeUnderflow!==(null!==(s=e.rangeUnderflow)&&void 0!==s&&s)||c.tooLong!==(null!==(d=e.tooLong)&&void 0!==d&&d)||c.tooShort!==(null!==(l=e.tooShort)&&void 0!==l&&l)||c.typeMismatch!==(null!==(u=e.typeMismatch)&&void 0!==u&&u)}_maybeValidate(){if(this._validate){const[e,t]=this._validate(this._state);this._validityDiffers(e)&&this._internals.setValidity(e,t,this._root)}}_changeState(e){super._changeState(e),this._internals.setFormValue(this._formValue(this._state)),this._maybeValidate()}}g.formAssociated=!0;const E=g,y=(e,t)=>{return!!e.hasAttribute(t)&&("true"===(i=e.getAttribute(t).toLowerCase())||""===i);var i},N=(e,t)=>{return!(!e.hasAttribute(t)||""===e.getAttribute(t))&&(i=parseFloat(e.getAttribute(t)),!Number.isNaN(i)&&i);var i},A=(e,t,i,n)=>{return n((a=e[t]!==i)?Object.assign(Object.assign({},e),{[t]:i}):e,a);var a},S=(e,t,i,n)=>A(e,t,i||void 0,n),w=(e,t,i,n)=>i instanceof Error?i:A(e,t,i,n);var C=t.uA,O=t.s2,T=t.Aq;export{C as Component,O as FormComponent,T as Utils};