var e,t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},n={};t.d(n,{uA:()=>m,s2:()=>p,xG:()=>b});var i="undefined"==typeof document?void 0:document,o=!!i&&"content"in i.createElement("template"),s=!!i&&i.createRange&&"createContextualFragment"in i.createRange();function a(e,t){var n,i,o=e.nodeName,s=t.nodeName;return o===s||(n=o.charCodeAt(0),i=s.charCodeAt(0),n<=90&&i>=97?o===s.toUpperCase():i<=90&&n>=97&&s===o.toUpperCase())}function r(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var d={OPTION:function(e,t){var n=e.parentNode;if(n){var i=n.nodeName.toUpperCase();"OPTGROUP"===i&&(i=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==i||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}r(e,t,"selected")},INPUT:function(e,t){r(e,t,"checked"),r(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var i=e.firstChild;if(i){var o=i.nodeValue;if(o==n||!n&&o==e.placeholder)return;i.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,i,o=-1,s=0,a=e.firstChild;a;)if("OPTGROUP"===(i=a.nodeName&&a.nodeName.toUpperCase()))a=(n=a).firstChild;else{if("OPTION"===i){if(a.hasAttribute("selected")){o=s;break}s++}!(a=a.nextSibling)&&n&&(a=n.nextSibling,n=null)}e.selectedIndex=o}}};function l(){}function c(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const h=function(t,n,r){if(r||(r={}),"string"==typeof n)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var h=n;(n=i.createElement("html")).innerHTML=h}else u=(u=n).trim(),n=o?function(e){var t=i.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(u):s?function(t){return e||(e=i.createRange()).selectNode(i.body),e.createContextualFragment(t).childNodes[0]}(u):function(e){var t=i.createElement("body");return t.innerHTML=e,t.childNodes[0]}(u);else 11===n.nodeType&&(n=n.firstElementChild);var u,f=r.getNodeKey||c,v=r.onBeforeNodeAdded||l,m=r.onNodeAdded||l,_=r.onBeforeElUpdated||l,p=r.onElUpdated||l,b=r.onBeforeNodeDiscarded||l,g=r.onNodeDiscarded||l,E=r.onBeforeElChildrenUpdated||l,y=r.skipFromChildren||l,N=r.addChild||function(e,t){return e.appendChild(t)},w=!0===r.childrenOnly,S=Object.create(null),O=[];function A(e){O.push(e)}function C(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var i=void 0;t&&(i=f(n))?A(i):(g(n),n.firstChild&&C(n,t)),n=n.nextSibling}}function T(e,t,n){!1!==b(e)&&(t&&t.removeChild(e),g(e),C(e,n))}function x(e){m(e);for(var t=e.firstChild;t;){var n=t.nextSibling,i=f(t);if(i){var o=S[i];o&&a(t,o)?(t.parentNode.replaceChild(o,t),M(o,t)):x(t)}else x(t);t=n}}function M(e,t,n){var o=f(t);if(o&&delete S[o],!n){if(!1===_(e,t))return;if(function(e,t){var n,i,o,s,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var r=a.length-1;r>=0;r--)i=(n=a[r]).name,o=n.namespaceURI,s=n.value,o?(i=n.localName||i,e.getAttributeNS(o,i)!==s&&("xmlns"===n.prefix&&(i=n.name),e.setAttributeNS(o,i,s))):e.getAttribute(i)!==s&&e.setAttribute(i,s);for(var d=e.attributes,l=d.length-1;l>=0;l--)i=(n=d[l]).name,(o=n.namespaceURI)?(i=n.localName||i,t.hasAttributeNS(o,i)||e.removeAttributeNS(o,i)):t.hasAttribute(i)||e.removeAttribute(i)}}(e,t),p(e),!1===E(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,o,s,r,l,c=y(e,t),h=t.firstChild,u=e.firstChild;e:for(;h;){for(r=h.nextSibling,n=f(h);!c&&u;){if(s=u.nextSibling,h.isSameNode&&h.isSameNode(u)){h=r,u=s;continue e}o=f(u);var m=u.nodeType,_=void 0;if(m===h.nodeType&&(1===m?(n?n!==o&&((l=S[n])?s===l?_=!1:(e.insertBefore(l,u),o?A(o):T(u,e,!0),u=l):_=!1):o&&(_=!1),(_=!1!==_&&a(u,h))&&M(u,h)):3!==m&&8!=m||(_=!0,u.nodeValue!==h.nodeValue&&(u.nodeValue=h.nodeValue))),_){h=r,u=s;continue e}o?A(o):T(u,e,!0),u=s}if(n&&(l=S[n])&&a(l,h))c||N(e,l),M(l,h);else{var p=v(h);!1!==p&&(p&&(h=p),h.actualize&&(h=h.actualize(e.ownerDocument||i)),N(e,h),x(h))}h=r,u=s}!function(e,t,n){for(;t;){var i=t.nextSibling;(n=f(t))?A(n):T(t,e,!0),t=i}}(e,u,o);var b=d[e.nodeName];b&&b(e,t)}(e,t):d.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var i=f(n);i&&(S[i]=n),e(n),n=n.nextSibling}}(t);var V,j,R=t,U=R.nodeType,H=n.nodeType;if(!w)if(1===U)1===H?a(t,n)||(g(t),R=function(e,t){for(var n=e.firstChild;n;){var i=n.nextSibling;t.appendChild(n),n=i}return t}(t,(V=n.nodeName,(j=n.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==j?i.createElementNS(j,V):i.createElement(V)))):R=n;else if(3===U||8===U){if(H===U)return R.nodeValue!==n.nodeValue&&(R.nodeValue=n.nodeValue),R;R=n}if(R===n)g(t);else{if(n.isSameNode&&n.isSameNode(R))return;if(M(R,n,w),O)for(var L=0,k=O.length;L<k;L++){var P=S[O[L]];P&&T(P,P.parentNode,!1)}}return!w&&R!==t&&t.parentNode&&(R.actualize&&(R=R.actualize(t.ownerDocument||i)),t.parentNode.replaceChild(R,t)),R},u=e=>"get"in e,f=["hashchange","popstate"];class v extends HTMLElement{constructor(e,t){super(),this._globalEvents={},this._localEvents={},this._deferredRedraw=!1,this._connected=!1,this._state="function"==typeof e.initialState?e.initialState(window):e.initialState,this._render=e.render,this._viewupdated=e.viewupdated,this._root=document.createElement("span"),this._styles=null==t?void 0:t.styles,this._domchange=e.domchange;let n=null==t?void 0:t.dommode;var i;n||(n="shadow"),this._document="shadow"===n?this.attachShadow({mode:"closed",clonable:!0,delegatesFocus:!0}):this,(null==t?void 0:t.styles)&&"light"===n&&document.adoptedStyleSheets.push(t.styles),e.events&&(this._globalEvents=(i=e.events,Object.keys(i).reduce(((e,t)=>f.includes(t)?Object.assign(Object.assign({},e),{[t]:i[t]}):e),{})),this._localEvents=(e=>Object.keys(e).reduce(((t,n)=>f.includes(n)?t:Object.assign(Object.assign({},t),{[n]:e[n]})),{}))(e.events)),e.props&&this._defineProps(e.props),this._emit=e.emit,this._globalEventHandler=this._globalEventHandler.bind(this),this._localEventHandler=this._localEventHandler.bind(this),this._debug=!!(null==t?void 0:t.debug)}_defineProps(e){const t=this;for(let[n,i]of Object.entries(e)){const e={};if(u(i)){const n=i.get,o=function(){return n(t._state)};e.get=o,o.bind(e)}Object.defineProperty(this,n,e)}}_localEventHandler(e){["submit"].includes(e.type)&&e.preventDefault(),e.stopImmediatePropagation();const t=this._localEvents[e.type];this._changeState(t(this._state,e,window))}_globalEventHandler(e){const t=this._globalEvents[e.type];this._changeState(t(this._state,e,window))}connectedCallback(){if(this._domchange){this._connectMutationObserver(this._domchange);const e="function"==typeof this._domchange?this._domchange:this._domchange.trigger;this._changeState(e(this._state,this,window))}this._root=this._render(this._state),this._document.appendChild(this._root),this._styles&&this._document instanceof ShadowRoot&&this._document.adoptedStyleSheets.push(this._styles),Object.keys(this._localEvents).forEach((e=>{this._document.addEventListener(e,this._localEventHandler,!0)})),Object.keys(this._globalEvents).forEach((e=>{window.addEventListener(e,this._globalEventHandler,!0)})),this._connected=!0,this._viewupdated&&this._changeState(this._viewupdated(this._state,this._root))}disconnectedCallback(){this._connected=!1,this._document.innerHTML="",this._document instanceof ShadowRoot&&(this._document.adoptedStyleSheets=[]),this._root=document.createElement("span"),this._maybeDisconnectMutationObserver(),Object.keys(this._localEvents).forEach((e=>{this._document.removeEventListener(e,this._localEventHandler,!0)})),Object.keys(this._globalEvents).forEach((e=>{window.removeEventListener(e,this._globalEventHandler,!0)}))}_connectMutationObserver(e){if(!this._domchangeObserver){const t="function"==typeof e?e:e.trigger,n=e=>{this._changeState(t(this._state,this,window))};this._domchangeObserver=new MutationObserver(n)}this._domchangeObserver.observe(this,"function"==typeof e?{subtree:!0,childList:!0,attributes:!0,characterData:!0}:e.options)}_maybeDisconnectMutationObserver(){this._domchangeObserver&&this._domchangeObserver.disconnect()}_redraw(){if(!this._connected)return;const e=this._render(this._state);this._root.isEqualNode(e)||(this._root.nodeName!==e.nodeName?(this._root.replaceWith(e),this._root=e):h(this._root,e,{getNodeKey:e=>"reference"in e?e.reference.deref().module:"module"in e?e.module:e.id,onBeforeElUpdated:(e,t)=>!(e.isEqualNode(t)||"reference"in t&&e.isEqualNode(t.reference.deref()))}),this._viewupdated&&this._changeState(this._viewupdated(this._state,this._root)))}_maybeEmitEvents(e){if(this._emit)for(const t of this._emit)t.when(e,this._state)&&(Array.isArray(t.emit)?t.emit.forEach((e=>{this.dispatchEvent(e(this._state))})):this.dispatchEvent(t.emit(this._state)))}_changeState(e){if(this._state===e)return;const t=this._state;this._state=e,this._deferredRedraw||(setTimeout((()=>{this._redraw(),this._deferredRedraw=!1}),0),this._deferredRedraw=!0),this._maybeEmitEvents(t),this._debug&&console.log("nikonov-components: transition from",t,"to",this._state)}}const m=v;class _ extends v{constructor(e,t){super(e,t),this._internals=this.attachInternals(),this._formValue=e.formValue,this._validate=e.validate,this._internals.setFormValue(this._formValue(this._state))}_validityDiffers(e){var t,n,i,o,s,a,r,d,l,c;const h=this._internals.validity;return h.valueMissing!==(null!==(t=e.valueMissing)&&void 0!==t&&t)||h.stepMismatch!==(null!==(n=e.stepMismatch)&&void 0!==n&&n)||h.badInput!==(null!==(i=e.badInput)&&void 0!==i&&i)||h.customError!==(null!==(o=e.customError)&&void 0!==o&&o)||h.patternMismatch!==(null!==(s=e.patternMismatch)&&void 0!==s&&s)||h.rangeOverflow!==(null!==(a=e.rangeOverflow)&&void 0!==a&&a)||h.rangeUnderflow!==(null!==(r=e.rangeUnderflow)&&void 0!==r&&r)||h.tooLong!==(null!==(d=e.tooLong)&&void 0!==d&&d)||h.tooShort!==(null!==(l=e.tooShort)&&void 0!==l&&l)||h.typeMismatch!==(null!==(c=e.typeMismatch)&&void 0!==c&&c)}_maybeValidate(){if(this._connected&&this._validate){const[e,t]=this._validate(this._state);this._validityDiffers(e)&&this._internals.setValidity(e,t,this._root)}}_changeState(e){super._changeState(e),this._internals.setFormValue(this._formValue(this._state)),this._maybeValidate()}}_.formAssociated=!0;const p=_,b=e=>{const t=new WeakMap;return Object.assign(Object.assign({},e),{render:n=>t.has(n)?(e=>{const n=t.get(e),i=n.cloneNode(!1);return i.reference=n,i})(n):(n=>{const i=e.render(n);return i.module=n,t.set(n,i),i})(n)})};var g=n.uA,E=n.s2,y=n.xG;export{g as Component,E as FormComponent,y as module};